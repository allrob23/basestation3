##
## Copyright (c) 2006, 2007, 2008, 2010, 2011, 2012, 2013, 2014, 2018, 2019, 2020, 2021 by University of Washington.  All rights reserved.
##
## This file contains proprietary information and remains the 
## unpublished property of the University of Washington. Use, disclosure,
## or reproduction is prohibited except as permitted by express written
## license agreement with the University of Washington.
##
## THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
## AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
## IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
## ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
## LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
## CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
## SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
## INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
## CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
## ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
## POSSIBILITY OF SUCH DAMAGE.
##


# A glider just logged out properly
history -T -h >>! history.log
rm -f .connected
# if running manually (not at logout) set this variable
if ( ! $?logout ) then
    setenv logout manual
endif
#echo Disconnected at `date` \(${logout}\) >>! comm.log
echo Disconnected at `date +"%a %b %d %R:%S %Z %Y"` \(${logout}\) >>! comm.log
printf "\n" >>! comm.log
printf "\n" >>! comm.log

if(! $?GLIDER_OPTIONS ) then
    set GLIDER_OPTIONS = ""
endif

if(! $?BASESTATION_PATH ) then
    set BASESTATION_PATH = "/usr/local/basestation"
endif

printf "\n" >>! baselog.log
printf "\n"  >>! baselog.log

python3.8 $BASESTATION_PATH/Base.py --mission_dir `pwd` --verbose --make_dive_profiles --make_mission_profile --make_mission_timeseries --daemon --base_log baselog_`date +%y%m%d%H%M%S` $GLIDER_OPTIONS >>&!  baselog.log
